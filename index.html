<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Health Companion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
        }
        .chat-container {
            max-width: 768px;
            height: 90vh;
            display: flex;
            flex-direction: column;
            border-radius: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            background-color: #2d3748;
            border: 1px solid #4a5568;
        }
        .chat-log {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .chat-log::-webkit-scrollbar {
            width: 8px;
        }
        .chat-log::-webkit-scrollbar-track {
            background: #2d3748;
        }
        .chat-log::-webkit-scrollbar-thumb {
            background-color: #4a5568;
            border-radius: 10px;
            border: 2px solid #2d3748;
        }
        .message {
            max-width: 80%;
            padding: 0.75rem 1rem;
            border-radius: 1.5rem;
            word-wrap: break-word;
            line-height: 1.5;
            animation: fadeIn 0.3s ease-in-out;
        }
        .user-message {
            background-color: #63b3ed;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 0.25rem;
        }
        .bot-message {
            background-color: #4a5568;
            color: #e2e8f0;
            align-self: flex-start;
            border-bottom-left-radius: 0.25rem;
        }
        .input-area {
            padding: 1rem;
            border-top: 1px solid #4a5568;
            display: flex;
            gap: 0.5rem;
        }
        .input-area input {
            flex-grow: 1;
            padding: 0.75rem 1rem;
            background-color: #4a5568;
            border: 1px solid #63b3ed;
            border-radius: 1.5rem;
            color: white;
            outline: none;
            transition: border-color 0.2s;
        }
        .input-area input:focus {
            border-color: #2b6cb0;
        }
        .input-area button {
            background-color: #63b3ed;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .input-area button:hover {
            background-color: #2b6cb0;
        }
        .loader {
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #63b3ed;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="chat-container">
        <!-- Chat Header -->
        <div class="p-4 text-center text-2xl font-bold bg-[#2d3748] border-b border-[#4a5568] rounded-t-2xl">
            Mental Health Companion
        </div>

        <!-- Chat Log Area -->
        <div class="chat-log" id="chat-log">
            <!-- Initial bot message -->
            <div class="bot-message message">
                Hello! I'm here to listen. How are you feeling today?
            </div>
        </div>

        <!-- User Input Area -->
        <div class="input-area">
            <input type="text" id="user-input" placeholder="Type your message here..." autocomplete="off">
            <button id="send-btn">Send</button>
        </div>
    </div>

    <script>
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const chatLog = document.getElementById('chat-log');
        
        // Data for keyword matching and responses
        const emotionalResponses = {
            'sad': [
                'I hear you. Feeling sad is okay. Try taking a moment for yourself to just breathe. Or maybe listen to some music that makes you feel a little lighter.',
                'It sounds like you are going through a tough time. It might help to write down what is on your mind. Just getting it out can make a difference.',
                'I am so sorry you feel that way. Connecting with a friend or a family member can often help. You are not alone in this.'
            ],
            'depressed': [
                'Feeling depressed is a heavy burden to carry. Please know that it is not your fault. Consider reaching out to a mental health professional who can offer specialized support. You deserve to feel better.',
                'I hear you. I cannot replace a professional, but I can remind you that you are valued. Sometimes, a walk in nature can help clear the mind, even for a few minutes.',
                'Depression can feel overwhelming. I am here to listen without judgment. If you are in crisis, please remember there are resources available, like the National Suicide Prevention Lifeline (988 in the U.S.).'
            ],
            'stressed': [
                'I am sorry to hear you are stressed. Try a simple breathing exercise: breathe in for four seconds, hold for four, and breathe out for six. Repeat a few times to calm your nervous system.',
                'Stress can feel like a lot to handle. Taking a break, even just for 15 minutes, can help. Maybe grab a cup of tea or listen to a relaxing podcast.',
                'Remember to focus on one thing at a time. It is okay to say "no" and to set boundaries to protect your energy.'
            ],
            'anxious': [
                'Anxiety is tough. Try the 5-4-3-2-1 grounding exercise: Name 5 things you can see, 4 things you can feel, 3 things you can hear, 2 things you can smell, and 1 thing you can taste. This can help you feel more present.',
                'Take a slow, deep breath. Anxiety can make your thoughts race. Focus on the feeling of your feet on the ground. You are safe in this moment.',
                'It is okay to feel anxious. A great way to cope is to go for a short walk. Physical movement can help ease some of the tension you feel.'
            ],
            'happy': [
                'That is wonderful to hear! I am so glad you are feeling good. What made you happy today?',
                'That is fantastic! It is so important to celebrate the good moments. Thank you for sharing your positivity with me.',
                'It is great to hear you are happy! Keep that energy going. Think about what made you feel this way and try to do it again soon.'
            ],
            'calm': [
                'That is a great state to be in. What helped you feel calm today?',
                'Peace is a wonderful feeling. You deserve this moment of tranquility.',
                'I am glad you are feeling calm. Let\'s cherish this feeling and remember it for when you need it.'
            ],
            'gratitude': [
                'That is a beautiful sentiment. Practicing gratitude can significantly improve your mental wellbeing. What are you grateful for today?',
                'Thank you for sharing that. It\'s amazing how much a little gratitude can change your perspective.'
            ]
        };

        const defaultResponses = [
            'Thank you for sharing. I am here to listen if you want to talk more.',
            'That is a very interesting thought. How does that make you feel?',
            'I understand. Sometimes it helps just to have someone listen. I am here for you.',
            'What you are saying is important. I am ready when you are to continue the conversation.',
        ];

        let conversationHistory = JSON.parse(localStorage.getItem('chatHistory')) || [];

        // Function to save chat history
        function saveChatHistory() {
            localStorage.setItem('chatHistory', JSON.stringify(conversationHistory));
        }

        // Function to display messages
        function displayMessage(text, sender) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('message');
            messageElement.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
            messageElement.textContent = text;
            chatLog.appendChild(messageElement);
            chatLog.scrollTop = chatLog.scrollHeight;
        }

        // Function to load and display conversation history
        function loadChatHistory() {
            if (conversationHistory.length > 0) {
                chatLog.innerHTML = '';
                conversationHistory.forEach(msg => {
                    displayMessage(msg.text, msg.sender);
                });
            }
        }

        // Function to get a response from the bot
        function getBotResponse(userText) {
            userText = userText.toLowerCase();

            // Check for a clear chat command
            if (userText.includes('clear chat')) {
                conversationHistory = [];
                saveChatHistory();
                chatLog.innerHTML = '<div class="bot-message message">Conversation cleared. How can I help you today?</div>';
                return;
            }

            // Find an emotional keyword
            for (const emotion in emotionalResponses) {
                if (userText.includes(emotion)) {
                    const responses = emotionalResponses[emotion];
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    return randomResponse;
                }
            }

            // If no emotional keyword is found, return a default response
            const randomDefaultResponse = defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
            return randomDefaultResponse;
        }

        // Function to handle sending a message
        function sendMessage() {
            const userText = userInput.value.trim();
            if (userText === '') return;

            // Display user message
            displayMessage(userText, 'user');
            conversationHistory.push({ text: userText, sender: 'user' });
            saveChatHistory();

            userInput.value = '';

            // Show a typing indicator
            const typingIndicator = document.createElement('div');
            typingIndicator.classList.add('bot-message', 'message', 'flex', 'items-center', 'gap-2');
            typingIndicator.innerHTML = 'Thinking...';
            chatLog.appendChild(typingIndicator);
            chatLog.scrollTop = chatLog.scrollHeight;

            setTimeout(() => {
                const botResponse = getBotResponse(userText);
                chatLog.removeChild(typingIndicator); // Remove typing indicator
                
                if (botResponse) {
                    displayMessage(botResponse, 'bot');
                    conversationHistory.push({ text: botResponse, sender: 'bot' });
                    saveChatHistory();
                }
            }, 1500); // Simulate a delay for a more realistic feel
        }

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        userInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Initial load
        loadChatHistory();
    </script>
</body>
</html>
